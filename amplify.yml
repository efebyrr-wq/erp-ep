version: 1

# Amplify hosting build configuration for frontend
# Works for all branches (main, staging, etc.)
# Ensures VITE_API_BASE_URL is set to CloudFront so production builds never fall back to HTTP.
env:
  variables:
    VITE_API_BASE_URL: https://d31tialuhzl449.cloudfront.net

frontend:
  phases:
    preBuild:
      commands:
        - 'echo "Building frontend for branch: $AWS_BRANCH"'
        - 'echo "Current directory: $(pwd)"'
        - 'echo "Listing files: $(ls -la)"'
        - cd frontend
        - npm install
    build:
      commands:
        - 'echo "Build phase - Current directory: $(pwd)"'
        - npm run build
        - echo "Build completed successfully"
  artifacts:
    baseDirectory: frontend/dist
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/* 


